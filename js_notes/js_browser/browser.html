<!--
@author: magician
@file:   browser.html
@date:   2020/1/31
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>browser</title>
    <script>
        // window
        // 可以调整浏览器窗口大小试试:
        console.log('window inner size: ' + window.innerWidth + ' x ' + window.innerHeight);

        // navigator
        console.log('appName = ' + navigator.appName);
        console.log('appVersion = ' + navigator.appVersion);
        console.log('language = ' + navigator.language);
        console.log('platform = ' + navigator.platform);
        console.log('userAgent = ' + navigator.userAgent);

        let width = window.innerWidth || window.innerHeight;
        console.log('window width: ' + width);

        // screen
        console.log('Screen size = ' + screen.width + ' x ' + screen.height);

        // location
        console.log(location.protocol);
        console.log(location.host);
        console.log(location.port);
        console.log(location.pathname);
        console.log(location.search);
        console.log(location.hash);

        // if (confirm('重新加载当前页' + location.href + '?')) {
        //     location.reload();
        // } else {
        //     location.assign('/'); // 设置一个新的URL地址
        // }

        // document
        document.title = '努力学习JavaScript!';

        // 返回ID为'test'的节点：
        // let test = document.getElementById('test');
        // 先定位ID为'test-table'的节点，再返回其内部所有tr节点：
        // let trs = document.getElementById('test-table').getElementsByTagName('tr');
        // 先定位ID为'test-div'的节点，再返回其内部所有class包含red的节点：
        // let reds = document.getElementById('test-div').getElementsByClassName('red');
        // 获取节点test下的所有直属子节点:
        // let cs = test.children;
        // 获取节点test下第一个、最后一个子节点：
        // let first = test.firstElementChild;
        // let last = test.lastElementChild;

        // 通过querySelector获取ID为q1的节点：
        // let q1 = document.querySelector('#q1');
        // 通过querySelectorAll获取q1节点内的符合条件的所有节点：
        // let ps = q1.querySelectorAll('div.highlighted > p');

        // 获取<p id="p-id">...</p>
        let p = document.getElementById('p-id');
        // 设置文本为abc:
        // p.innerHTML = 'ABC';
        // 设置HTML:
        // p.innerHTML = 'ABC<span style="color: red">RED</span> XYZ';
        // 设置文本:
        // p.innerText = 'ABC';
        // 设置CSS:
        p.style.color = '#ff0000';
        p.style.fontSize = '20px';
        p.style.paddingTop = '2em';
    </script>
</head>
<body>
    <dl id="drink-menu" style="border:solid 1px #ccc;padding:6px;">
        <dt>摩卡</dt>
        <dd>热摩卡咖啡</dd>
        <dt>酸奶</dt>
        <dd>北京老酸奶</dd>
        <dt>果汁</dt>
        <dd>鲜榨苹果汁</dd>
    </dl>

    <div id="test-div">
        <div class="c-red">
            <p id="test-p">JavaScript</p>
            <p>Java</p>
        </div>
        <div class="c-red c-green">
            <p>Python</p>
            <p>Ruby</p>
            <p>Swift</p>
        </div>
        <div class="c-green">
            <p>Scheme</p>
            <p>Haskell</p>
        </div>
    </div>

    <div id="test-div1">
        <p id="test-js">javascript</p>
        <p>Java</p>
    </div>

    <p id="js">JavaScript</p>
    <div id="list">
        <p id="java">Java</p>
        <p id="python">Python</p>
        <p id="scheme">Scheme</p>
    </div>

    <ol id="test-list">
        <li class="lang">Scheme</li>
        <li class="lang">JavaScript</li>
        <li class="lang">Python</li>
        <li class="lang">Ruby</li>
        <li class="lang">Haskell</li>
    </ol>

    <div id="parent">
        <p>First</p>
        <p>Second</p>
    </div>

    <ul id="test-list1">
        <li>JavaScript</li>
        <li>Swift</li>
        <li>HTML</li>
        <li>ANSI</li>
        <li>CSS</li>
        <li>DirectX</li>
    </ul>

    <script>
        // let menu = document.getElementById('drink-menu');
        let drinks = document.getElementsByTagName('dt');
        let i, s;

        s = '提供的饮料有:';
        for (i = 0; i < drinks.length; i++) {
            s = s + drinks[i].innerHTML + ',';
        }
        console.log(s);

        // cookies
        console.log(document.cookie);

        // 选择<p>JavaScript</p>:
        let js = document.getElementById('test-p');
        // 选择<p>Python</p>,<p>Ruby</p>,<p>Swift</p>:
        let arr = document.getElementsByClassName('c-red')[1].children;
        // 选择<p>Haskell</p>:
        let haskell = document.getElementsByClassName('c-green')[1].lastElementChild;
        // 测试:
        if (!js || js.innerText !== 'JavaScript') {
            alert('选择JavaScript失败!');
        } else if (!arr || arr.length !== 3 || !arr[0] || !arr[1] || !arr[2] || arr[0].innerText !== 'Python' || arr[1].innerText !== 'Ruby' || arr[2].innerText !== 'Swift') {
            console.log('选择Python,Ruby,Swift失败!');
        } else if (!haskell || haskell.innerText !== 'Haskell') {
            console.log('选择Haskell失败!');
        } else {
            console.log('测试通过!');
        }

        // 获取<p>javascript</p>节点:
        let js1 = document.getElementById('test-js');

        // 修改文本为JavaScript:
        js1.innerHTML = 'JavaScript';

        // 修改CSS为: color: #ff0000, font-weight: bold
        js1.style.color = '#ff0000';
        js1.style.fontWeight = 'bold';
        // 测试:
        if (js && js.parentNode && js.parentNode.id === 'test-div' && js.id === 'test-js') {
            if (js.innerText === 'JavaScript') {
                if (js.style && js.style.fontWeight === 'bold' && (js.style.color === 'red' || js.style.color === '#ff0000' || js.style.color === '#f00' || js.style.color === 'rgb(255, 0, 0)')) {
                    console.log('测试通过!');
                } else {
                    console.log('CSS样式测试失败!');
                }
            } else {
                console.log('文本测试失败!');
            }
        } else {
            console.log('节点测试失败!');
        }

        let js2 = document.getElementById('js'),
            list = document.getElementById('list');
        list.appendChild(js2);

        let haskell1 = document.createElement('p');
        haskell1.id = 'haskell';
        haskell1.innerText = 'Haskell';
        list.appendChild(haskell1);

        let d = document.createElement('style');
        d.setAttribute('type', 'text/css');
        d.innerHTML = 'p { color: red }';
        document.getElementsByTagName('head')[0].appendChild(d);

        // insertBefore
        let ref = document.getElementById('python');
        let haskell2 = document.createElement('p');
        haskell2.id = 'haskell';
        haskell2.innerText = 'Haskell';
        list.insertBefore(haskell2, ref);

        // sort list:
        let arr1 = [];
        let list1 = document.getElementById('test-list');

        for (let i = 0; i < list1.children.length; i++) {
            arr1.push(list1.children[i].innerText);
        }
        arr1.sort();

        for (let i = 0; i < arr1.length; i++) {
            list1.children[i].innerText = arr1[i];
        }

        // 拿到待删除节点:
        // let self = document.getElementById('to-be-removed');
        // 拿到父节点:
        // let parent = self.parentElement;
        // 删除:
        // let removed = parent.removeChild(self);
        // console.log(removed === self);

        let parent = document.getElementById('parent');
        parent.removeChild(parent.children[0]);
        // parent.removeChild(parent.children[1]);

        let parent1 = document.getElementById('test-list1');
        let arr2 = Array.from(parent1.children);

        let res = arr2.filter(function (x) {
            return ['JavaScript', 'HTML', 'CSS'].indexOf(x.innerText) === -1;
        });
        for (let i = 0; i < res.length; i++) {
            parent1.removeChild(res[i]);
        }
        // 测试:
        (function () {
            let
                arr, i,
                t = document.getElementById('test-list');
            if (t && t.children && t.children.length === 3) {
                arr = [];
                for (i = 0; i < t.children.length; i++) {
                    arr.push(t.children[i].innerText);
                }
                if (arr.toString() === ['JavaScript', 'HTML', 'CSS'].toString()) {
                    console.log('测试通过!');
                } else {
                    console.log('测试失败: ' + arr.toString());
                }
            } else {
                console.log('测试失败!');
            }
        })();
    </script>
</body>
</html>